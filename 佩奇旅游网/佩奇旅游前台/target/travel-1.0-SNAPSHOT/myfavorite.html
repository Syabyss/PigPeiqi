<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>我的收藏</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/common.css">
    <link rel="stylesheet" href="css/index.css">
    <style>
        .tab-content .row>div {
            margin-top: 16px;
        }
        .tab-content {
            margin-bottom: 36px;
        }
    </style>
    <script src="js/jquery-3.3.1.js"></script>
    <script src="js/getParameter.js"></script>

    <script>

        /**
         * 我的收藏分页展示
         */
        $(function () {

            let currentPage = getParameter("currentPage");
            load(currentPage);

        });


        function load(currentPage) {

            $.get("user/findMyFavorite", {currentPage: currentPage}, function (pageBean) {
                // 解析pageBean数据，展示到页面上

                if (pageBean == null) {
                    $("#favorite_routes").html('<meta charset="utf-8"><table width="100%"><tr><td style="width: 100%;"><center><table class="content-wrap" style="margin: 0px auto; width: 600px;"><tr><td style="margin: 0px auto; overflow: hidden; padding: 0px; border: 0px dotted rgb(238, 238, 238);"><!----><div class="full" tindex="1" style="margin: 0px auto; line-height: 0px; max-width: 600px;"><table align="center" border="0" cellpadding="0" cellspacing="0" class="fullTable" style="width: 600px;"><tbody><tr><td align="center" class="fullTd" style="direction: ltr; font-size: 0px; padding: 20px; text-align: center; vertical-align: top; word-break: break-word; width: 600px;  background-repeat: no-repeat; background-size: 100px; background-position: 10% 50%;"><table align="center" border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border-spacing: 0px;"><tbody><tr><td style="width: 600px; border-top: 1px solid rgb(204, 204, 204);"></td></tr></tbody></table></td></tr></tbody></table></div><div tindex="2" style="margin: 0px auto; max-width: 600px;"><table align="center" border="0" cellpadding="0" cellspacing="0" style="background-color: rgb(255, 255, 255);background-repeat: no-repeat; background-size: 100px; background-position: 1% 50%;"><tbody><tr><td style="direction: ltr; font-size: 0px; text-align: center; vertical-align: top; width: 600px;"><table width="100%" border="0" cellpadding="0" cellspacing="0" style="vertical-align: top;"><tbody><tr><td class="twoColumn column1" style="width: 50%; max-width: 50%; min-height: 1px; font-size: 13px; text-align: left; direction: ltr; vertical-align: top; padding: 0px;"><div class="full" style="margin: 0px auto; max-width: 600px;"><table align="center" border="0" cellpadding="0" cellspacing="0" class="fullTable" style="width: 300px;"><tbody><tr><td class="fullTd" style="direction: ltr; width: 300px; font-size: 0px; padding-bottom: 0px; text-align: center; vertical-align: top;"><div style="display: inline-block; vertical-align: top; width: 100%;"><table border="0" cellpadding="0" cellspacing="0" width="100%" style="vertical-align: top;"><tr><td style="font-size: 0px; word-break: break-word; width: 280px; text-align: center; padding: 15px 10px;"><div><img height="auto" alt="拖拽生成HTML邮件-拉易网-3" width="auto" src="https://www.drageasy.com/5c3572e8d3ead944a18b3bc946e88207.jpg?imageslim" style="box-sizing: border-box; border: 0px; display: inline-block; outline: none; text-decoration: none; height: auto; width: auto; max-width: 100%; padding: 0px;"></div></td></tr></table></div></td></tr></tbody></table></div></td><td class="twoColumn column2" style="width: 50%; max-width: 50%; min-height: 1px; font-size: 13px; text-align: left; direction: ltr; vertical-align: top; padding: 0px;"><div columnnumber="2"><table align="center" border="0" cellpadding="0" cellspacing="0" style="width: 100%;"><tbody><tr><td style="direction: ltr; font-size: 0px; text-align: center; vertical-align: top; border: 0px;"><div class="mj-column-per-50" style="width: 100%; max-width: 100%; font-size: 13px; text-align: left; direction: ltr; display: inline-block; vertical-align: top;"><table border="0" cellpadding="0" cellspacing="0" width="100%" style="border-collapse: collapse; border-spacing: 0px; width: 100%; vertical-align: top;"><tr><td align="center" border="0" style="font-size: 0px; word-break: break-word;"><div class="full" style="margin: 0px auto; max-width: 600px;"><table align="center" border="0" cellpadding="0" cellspacing="0" class="fullTable" style="width: 300px;"><tbody><tr><td class="fullTd" style="direction: ltr; width: 300px; font-size: 0px; padding-bottom: 0px; text-align: center; vertical-align: top;background-repeat: no-repeat; background-size: 100px; background-position: 10% 50%;"><table border="0" cellpadding="0" cellspacing="0" width="100%" style="vertical-align: top;"><tr><td align="left" style="font-size: 0px; padding: 56px 0px;"><div class="text" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; overflow-wrap: break-word; margin: 0px; text-align: left; line-height: 25px; color: rgb(51, 51, 51); font-size: 14px; font-weight: normal;"><div><h2 style="line-height: 36px; font-size: 1.5em; font-weight: bold; margin: 0px;">温馨提示：</h2></div></div></td></tr></table></td></tr></tbody></table></div></td></tr></table></div><div class="mj-column-per-50" style="width: 100%; max-width: 100%; font-size: 13px; text-align: left; direction: ltr; display: inline-block; vertical-align: top;"><table border="0" cellpadding="0" cellspacing="0" width="100%" style="border-collapse: collapse; border-spacing: 0px; width: 100%; vertical-align: top;"><tr><td align="center" border="0" style="font-size: 0px; word-break: break-word;"><div class="full" style="margin: 0px auto; max-width: 600px;"><table align="center" border="0" cellpadding="0" cellspacing="0" class="fullTable" style="width: 300px;"><tbody><tr><td class="fullTd" style="direction: ltr; width: 300px; font-size: 0px; padding-bottom: 0px; text-align: center; vertical-align: top;background-repeat: no-repeat; background-size: 100px; background-position: 10% 50%;"><table border="0" cellpadding="0" cellspacing="0" width="100%" style="vertical-align: top;"><tr><td align="left" style="font-size: 0px; padding: 0px 0px 5px;"><div class="text" style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; overflow-wrap: break-word; margin: 0px; text-align: left; line-height: 25px; color: rgb(51, 51, 51); font-size: 14px; font-weight: normal;"><div><p style="text-size-adjust: none; word-break: break-word; line-height: 25px; font-size: 14px; margin: 0px;">&nbsp; &nbsp; 您还没有进行登录，请先完成登录再来查看！</p></div></div></td></tr></table></td></tr></tbody></table></div></td></tr></table></div></td></tr></tbody></table></div></td></tr></tbody></table></td></tr></tbody></table></div><div class="full" tindex="3" style="margin: 0px auto; max-width: 600px;"><table align="center" border="0" cellpadding="0" cellspacing="0" class="fullTable" style="width: 600px;"><tbody><tr><td align="center" vertical-align="middle" style="font-size: 0px; word-break: break-word; width: 600px; padding: 62px 20px;background-size: 100px; background-position: 10% 50%; background-repeat: no-repeat;"><table align="center" border="0" cellpadding="0" cellspacing="0" style="border-collapse: separate; line-height: 1;"><tr><td align="center" valign="middle" style="line-height: 1; background-color: rgb(255, 87, 87); padding: 17px 43px;"><a target="_blank" href="http://localhost/travel/login.html" style="font-size: 0px; text-decoration: none;"><p style="font-family: 微软雅黑, &quot;Microsoft YaHei&quot;; margin: 0px; color: rgb(255, 255, 255); line-height: 1; font-size: 12px; font-weight: normal; text-decoration: none; text-transform: none;"><span>点我跳转到登录界面</span></p></a></td></tr></table></td></tr></tbody></table></div><div class="full" tindex="4" style="margin: 0px auto; line-height: 0px; max-width: 600px;"><table align="center" border="0" cellpadding="0" cellspacing="0" class="fullTable" style="width: 600px;"><tbody><tr><td align="center" class="fullTd" style="direction: ltr; font-size: 0px; padding: 20px 0px; text-align: center; vertical-align: top; word-break: break-word; width: 600px;background-repeat: no-repeat; background-size: 100px; background-position: 10% 50%;"><table align="center" border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse; border-spacing: 0px;"><tbody><tr><td style="width: 600px; border-top: 1px solid rgb(204, 204, 204);"></td></tr></tbody></table></td></tr></tbody></table></div></td></tr></table></center></td></tr></table><!----><center style="text-align:center;font-size: 12px;margin:5px;color:rgb(102, 102, 102);transform: scale(.9);-webkit-transform: scale(.9);"></center>');
                }

                if (pageBean["totalCount"] === 0) {
                    $("#favorite_routes").html('<span id="nofavorite">您还没有任何收藏哦，去看一看线路列表吧</span>');
                }

                let pageLis = "";
                // let href = '"localhost/travel/route_list.html?cid="''';
                let firstPage = '<li onclick="load('+ 1 + ')"><a href="myfavorite.html">首页</a></li>';
                let previousPageNum = pageBean.currentPage-1 < 1 ? 1 : pageBean.currentPage-1;      // 计算上一页页码
                let previousPage = '<li onclick="load('+ previousPageNum +')" class="threeword">' +
                    '<a href="myfavorite.html?currentPage='+ previousPageNum +'">上一页</a></li>';
                pageLis += firstPage + previousPage;
                let begin, end;
                // 1.要显示10个页码
                if (pageBean["totalPage"] < 10) {   // 总页码不够10页
                    begin = 1;
                    end = pageBean["totalPage"];
                } else {    // 总页码超过10页
                    begin = currentPage - 5;
                    end = currentPage + 4;
                    // 2.如果前面不够5个，后面补齐10个
                    if (begin < 1) {
                        begin = 1;
                        end = begin + 9;
                    }
                    // 3.如果后面不足4个，前面补齐10个
                    if (end > pageBean["totalPage"]) {
                        end = pageBean["totalPage"];
                        begin = end - 9;
                    }
                }

                for (let i = begin; i <= end; i++) {
                    let li;
                    if (pageBean["currentPage"] === i) {
                        // 对当前页码添加特殊的CSS样式
                        li = '<li class="curPage" onclick="load('+ i +')">' +
                            '<a href="myfavorite.html?currentPage='+ i +'">'+ i +'</a></li>';
                    } else {
                        li = '<li onclick="load('+ i +'">' +
                            '<a href="myfavorite.html?currentPage='+ i +'">'+ i +'</a></li>';
                    }
                    pageLis += li;
                }

                let nextPageNum = pageBean.currentPage+1 > pageBean["totalPage"] ? pageBean["totalPage"] : pageBean.currentPage+1;      // 计算下一页页码
                let nextPage = '<li onclick="load('+ nextPageNum +')" class="threeword">' +
                    '<a href="myfavorite.html?currentPage='+ nextPageNum +'">下一页</a></li>';
                let lastPage = '<li onclick="load('+ pageBean["totalPage"] +')" class="threeword">' +
                    '<a href="myfavorite.html?currentPage='+ pageBean.totalPage +'">末页</a></li>';
                pageLis += nextPage + lastPage;

                // 将lis内容设置到ul中
                $("#ulPageNum").html(pageLis);

                // 2.列表数据展示
                let routeLis = '';

                for(let i = 0; i < pageBean.list.length; i ++) {
                    let route = pageBean.list[i];
                    let div = '<div class="col-md-3">\n' +
                        '                            <a href="route_detail.html?rid='+ route.rid +'">\n' +
                        '                                <img src="'+ route.rimage +'" alt="">\n' +
                        '                                <div class="has_border">\n' +
                        '                                    <h3>'+ route.rname +'</h3>\n' +
                        '                                    <div class="price">网付价<em>￥</em><strong>'+ route.price +'</strong><em>起</em></div>\n' +
                        '                                </div>\n' +
                        '                            </a>\n' +
                        '                        </div>';
                    routeLis += div;
                }

                $("#favorite_routes").html(routeLis);

            });

        }

    </script>

</head>
<body>
<!--引入头部-->
<div id="header"></div>
<!-- 排行榜 start-->
<section id="content">
    <section class="hemai_jx">
        <div class="jx_top">
            <div class="jx_tit">
                <img src="images/icon_5.jpg" alt="">
                <span>我的收藏</span>
            </div>
        </div>
        <div class="jx_content" id="jx_content">
            <!--可以添加一些渲染-->
            <!--                    <span id="notlogin">您尚未登录，请<a href="login.html">登录</a></span>-->
            <!-- Tab panes -->
            <div class="tab-content">
                <div role="tabpanel" class="tab-pane active" id="home">
                    <div class="row" id="favorite_routes">

                    </div>
                </div>
            </div>
        </div>
        <div class="pageNum">
            <ul id="ulPageNum">
                <li><a href="">首页</a></li>
                <li class="threeword"><a href="#">上一页</a></li>

                <li class="threeword"><a href="javascript:;">下一页</a></li>
                <li class="threeword"><a href="javascript:;">末页</a></li>
            </ul>
        </div>
    </section>
</section>
<!-- 排行榜 end-->

<!--引入尾部-->
<div id="footer"></div>
<!--导入布局js，共享header和footer-->
<script type="text/javascript" src="js/include.js"></script>
</body>
</html>